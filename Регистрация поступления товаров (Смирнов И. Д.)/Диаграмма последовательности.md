![alt text](../assets/reg.png)

```
@startuml
actor "Кладовщик" as Clerk
participant "WarehouseController" as Controller
participant "WarehouseFacade" as Facade
participant "RegisterGoodsReceiptUseCase" as ReceiptUseCase
participant "ReceiptRepository" as ReceiptRepo
participant "LocationAssignmentContext" as AssignmentContext
participant "LocationAssignmentService" as AssignmentService
participant "MovementService" as MovementSvc

Clerk -> Controller: receiveGoods(ReceiptDto)
Controller -> Facade: receiveGoods(ReceiptCommand)
Facade -> ReceiptUseCase: execute(command)

ReceiptUseCase -> ReceiptRepo: nextIdentity()
ReceiptRepo --> ReceiptUseCase: ReceiptId

ReceiptUseCase -> AssignmentContext: executeStrategy(dimensions, quantity)
AssignmentContext -> AssignmentService: findOptimalLocation(dimensions, quantity)
AssignmentService --> AssignmentContext: LocationId
AssignmentContext --> ReceiptUseCase: LocationId

ReceiptUseCase -> MovementSvc: recordReceiptMovement(productId, quantity, locationId)
MovementSvc --> ReceiptUseCase: MovementId

ReceiptUseCase -> ReceiptRepo: save(Receipt)
ReceiptRepo --> ReceiptUseCase: void

ReceiptUseCase --> Facade: Result<ReceiptId>
Facade --> Controller: Result<ReceiptId>
Controller --> Clerk: подтверждение (ReceiptId)
@enduml
```
