![alt text](../assets/warehouse-report.png)

```
@startuml
actor "Менеджер склада" as Manager

participant "UI" as UI
participant "WarehouseSystemFacade" as Facade
participant "Warehouse" as Warehouse
participant "StockReport" as Report
participant "StorageLocation" as Location
participant "ProductBatch" as Batch
participant "Product" as Product
participant "StockReportItem" as Item

== Открытие раздела отчетов ==

Manager -> UI: Открывает раздел\n«Отчеты о состоянии склада»
activate UI

UI -> Facade: generateStockReport()
activate Facade

Facade --> Report : <<create>>
activate Report

Facade -> Report: generateReport()

note right of Report
  StockReport сам обходит склад,
  собирает данные по местам хранения
  и партиям, и создаёт StockReportItem.
end note

== Внутренняя логика генерации отчёта ==

Report -> Warehouse: getStorageLocations()
activate Warehouse
Warehouse --> Report: List<StorageLocation>
deactivate Warehouse

loop Для каждого StorageLocation
    Report -> Location: getProductBatches()
    activate Location
    Location --> Report: List<ProductBatch>
    deactivate Location

    loop Для каждой ProductBatch
        Report -> Batch: getProduct()
        activate Batch
        Batch --> Report: Product

        Report -> Batch: getQuantity()
        Batch --> Report: quantity
        deactivate Batch

        Report -> Product: getMinStockLevel(),\n getMaxStockLevel()
        activate Product
        Product --> Report: minLevel, maxLevel
        deactivate Product

        Report --> Item : <<create>>
        activate Item

        Report -> Item: checkStatus()
        Item --> Report: StockStatus
        deactivate Item

        Report -> Report: addItem(Item)
    end
end

Report --> Facade: готовый StockReport
deactivate Report

== Отображение отчёта ==

Facade --> UI: StockReport
deactivate Facade

UI --> Manager: Отображает отчёт\nо состоянии склада
deactivate UI

@enduml
```
