![alt text](../assets/warehouse-report.png)

```
@startuml
actor "Менеджер склада" as Manager

participant UI
participant "WarehouseReportFacade" as ReportFacade
participant "WarehouseManager" as ManagerEntity
participant "IReportRepository" as IReportRepository
participant "ReportRepository" as ReportRepository
participant Database

' Менеджер открывает раздел "Отчеты склада"
Manager -> UI: Выбирает раздел "Отчеты склада"
activate UI

UI -> ReportFacade: GetAvailableReports(managerId: uInt32)
activate ReportFacade

ReportFacade -> ManagerEntity: ManagerEntity.getAllowedReportTypes()
activate ManagerEntity
ManagerEntity -> ReportFacade: reportTypes
deactivate ManagerEntity

ReportFacade -> IReportRepository: GetReportDefinitions(reportTypes)
activate IReportRepository

IReportRepository -> ReportRepository: GetReportDefinitions(reportTypes)
activate ReportRepository

ReportRepository -> Database: SELECT * FROM report_definitions WHERE type IN (reportTypes)
activate Database

Database --> ReportRepository: List<ReportDefinition>
deactivate Database

ReportRepository --> IReportRepository: List<ReportDefinition>
deactivate ReportRepository

IReportRepository --> ReportFacade: List<ReportDefinition>
deactivate IReportRepository

ReportFacade -> UI: List<ReportDefinition>
deactivate ReportFacade

UI --> Manager: Отображает список доступных отчетов
deactivate UI


' Менеджер выбирает отчет по остаткам и задает период
Manager -> UI: Выбирает "Отчет по остаткам" и задает период
activate UI

UI -> ReportFacade: GenerateStockReport(managerId: uInt32,\n period: DateRange, filters: ReportFilters)
activate ReportFacade

ReportFacade -> IReportRepository: GenerateStockReport(period, filters)
activate IReportRepository

IReportRepository -> ReportRepository: GenerateStockReport(period, filters)
activate ReportRepository

ReportRepository -> Database: SELECT ... FROM stock, items, locations\nWHERE date BETWEEN period.from AND period.to\nAND filters...
activate Database

Database --> ReportRepository: ReportDataSet
deactivate Database

ReportRepository --> IReportRepository: ReportDataSet
deactivate ReportRepository

IReportRepository --> ReportFacade: ReportDataSet
deactivate IReportRepository

ReportFacade -> UI: ReportViewModel
deactivate ReportFacade

UI --> Manager: Отображает отчет по остаткам
deactivate UI

@enduml
```