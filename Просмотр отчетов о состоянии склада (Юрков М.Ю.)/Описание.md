
# Рамки: Приложение информационной системы склада

## Сценарий: Просмотр отчёта о состоянии склада

## Уровень: Задача, определённая пользователем

## Основной исполнитель: Менеджер склада


## Заинтересованные лица и их интересы

* **Менеджер склада**

  * Хочет видеть актуальные остатки товаров по складу.
  * Хочет быстро видеть товары с проблемным уровнем запасов (ниже минимума, выше максимума, нет в наличии).

* **Компания**

  * Хочет контролировать складские запасы и избегать дефицита и излишков.


## Предусловия

* Менеджер склада авторизован в системе.
* В системе доступны:

  * справочник товаров (`Product`) с настроенными минимальными и максимальными уровнями запасов;
  * данные об остатках по товарам (на основе ранее зарегистрированных операций).
* Пользователь имеет право на просмотр отчёта о состоянии склада.


## Результаты (постусловия)

* Сформирован объект отчёта `StockReport`.
* На экране менеджера отображается отчёт о текущем состоянии склада:

  * список товаров;
  * текущий остаток по каждому товару;
  * минимальный и максимальный уровни;
  * статус по каждому товару (норма / ниже минимального / выше максимального / нет в наличии).


## Основной успешный сценарий

1. **Менеджер открывает раздел «Отчёты о состоянии склада» в интерфейсе.**

   * UI отображает экран с кнопкой/действием «Сформировать отчёт».

2. **Менеджер инициирует формирование отчёта.**

   * Менеджер нажимает кнопку «Сформировать отчёт» (или «Обновить»).

3. **UI запрашивает формирование отчёта у серверной логики.**

   * UI отправляет запрос фасаду:
     `WarehouseSystemFacade.generateStockReport()`.

4. **Фасад создаёт объект отчёта.**

   * `WarehouseSystemFacade` создаёт экземпляр `StockReport`.

5. **Фасад делегирует генерацию отчёта объекту `StockReport`.**

   * Фасад вызывает у отчёта метод:
     `StockReport.generateReport()`.

6. **`StockReport` формирует данные по товарам.**
   Внутри `generateReport()` отчёт:

   1. Последовательно обрабатывает каждый товар (`Product`), по которому нужно отразить остатки.
   2. Для каждого товара вызывает:
      `Product.checkStockLevel()`
      и получает текущее значение остатка.
   3. Создаёт элемент отчёта `StockReportItem` для данного товара.
   4. Вызывает у элемента отчёта метод:
      `StockReportItem.checkStatus()`
      для определения статуса (например: НОРМА, BELOW_MIN, ABOVE_MAX, OUT_OF_STOCK).
   5. Добавляет сформированный `StockReportItem` во внутренний список `items` отчёта.

7. **Завершение формирования отчёта.**

   * После обработки всех товаров `StockReport` содержит полный список элементов отчёта.
   * `StockReport` возвращается фасаду `WarehouseSystemFacade`.

8. **Фасад возвращает отчёт в UI.**

   * `WarehouseSystemFacade` передаёт готовый объект `StockReport` в UI.

9. **UI отображает отчёт менеджеру.**

   * Интерфейс визуализирует `StockReport` в виде таблицы:

     * товар;
     * текущий остаток;
     * минимальный и максимальный уровни;
     * статус.
   * Менеджер просматривает текущую картину состояния склада.


## Альтернативные потоки

### А1. По товарам нет данных для отображения

* При выполнении `generateReport()` не найдено ни одного товара с данными об остатках.
* `StockReport` возвращается с пустым списком элементов.
* UI отображает пустой отчёт и сообщение:
  *«Нет данных для отображения текущего состояния склада».*

### А2. Ошибка при формировании отчёта

* В процессе выполнения `generateReport()` возникает ошибка (например, недоступен источник данных).
* Фасад возвращает в UI информацию о неуспешном формировании отчёта.
* UI показывает менеджеру сообщение об ошибке и предлагает повторить попытку позже.


## Специальные требования

* Формирование отчёта должно выполняться за приемлемое время при типичном количестве товаров.
* Интерфейс должен позволять повторно сформировать отчёт (кнопка «Обновить»).


